
        IP Packet
_____________________________________________________________________________
| Version | IHL |  Type of Service (TOS)  |          Total Length             |
|   4     |  5   |     (8 bits - DSCP)      |               (16 bits)           |
|_________|______|________________________|___________________________________|
|         Identification        | Flags |      Fragment Offset              |
|           (16 bits)          | (3)   |             (13 bits)             |
|______________________________|_______|___________________________________|
|         Time to Live (TTL)    |   Protocol  |         Header Checksum         |
|           (8 bits)           |   (8 bits)   |             (16 bits)           |
|______________________________|____________|___________________________________|
|                       Source IP Address (32 bits)                        |
|___________________________________________________________________________|
|                     Destination IP Address (32 bits)                      |
|___________________________________________________________________________|
|                               Options (if any)                            |
|___________________________________________________________________________|
|                                  Data (payload)                             |
|___________________________________________________________________________|


           Ethernet packet


 _____________________________________________________________________________
|        Destination MAC Address (48 bits)       |    Source MAC Address (48 bits)   |
|________________________________________________|___________________________________|
|     EtherType/Length      | 802.1Q Tag (optional)   |          Data (payload)         |
|        (16 bits)         | (32 bits - VLAN Tag)     |       (46-1500 bytes)          |
|__________________________|__________________________|___________________________________|
|          FCS (Frame Check Sequence) (32 bits)           |
|_______________________________________________________|

vlan tag

| TPID (16 bits) | PCP (3 bits) | DEI (1 bit) | VID (12 bits) |
|________________|______________|____________|______________|


mpls packet header

 _____________________________________________________________________________
|   Label Stack Entry (20 bits)    |   Traffic Class (TC) (3 bits)   |   TTL (8 bits)   |
|__________________________________|________________________________|__________________|
|          Label (20 bits)          | Experimental (Exp) (3 bits)    |    S (1 bit)   |
|__________________________________|________________________________|__________________|
|                                  Data (payload)                             |
|___________________________________________________________________________|



   
